2025-03-13 10:30:11,604 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Current SDK version is 0.15.8
2025-03-13 10:30:11,605 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Configure stats pid to 44695
2025-03-13 10:30:11,605 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Loading settings from /cluster/home/shiqian/.config/wandb/settings
2025-03-13 10:30:11,605 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Loading settings from /cluster/home/shiqian/frame-flow-github/wandb/settings
2025-03-13 10:30:11,605 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'mode': 'offline'}
2025-03-13 10:30:11,605 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2025-03-13 10:30:11,605 INFO    MainThread:44695 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'experiments/train_se3_flows.py', 'program': '/cluster/home/shiqian/frame-flow-github/experiments/train_se3_flows.py'}
2025-03-13 10:30:11,606 INFO    MainThread:44695 [wandb_init.py:_log_setup():507] Logging user logs to ./wandb/offline-run-20250313_103011-4pgirfpr/logs/debug.log
2025-03-13 10:30:11,606 INFO    MainThread:44695 [wandb_init.py:_log_setup():508] Logging internal logs to ./wandb/offline-run-20250313_103011-4pgirfpr/logs/debug-internal.log
2025-03-13 10:30:11,606 INFO    MainThread:44695 [wandb_init.py:init():547] calling init triggers
2025-03-13 10:30:11,606 INFO    MainThread:44695 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2025-03-13 10:30:11,606 INFO    MainThread:44695 [wandb_init.py:init():596] starting backend
2025-03-13 10:30:11,607 INFO    MainThread:44695 [wandb_init.py:init():600] setting up manager
2025-03-13 10:30:11,615 INFO    MainThread:44695 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-03-13 10:30:11,633 INFO    MainThread:44695 [wandb_init.py:init():606] backend started and connected
2025-03-13 10:30:11,649 INFO    MainThread:44695 [wandb_init.py:init():697] updated telemetry
2025-03-13 10:30:11,746 INFO    MainThread:44695 [wandb_init.py:init():730] communicating run to backend with 60.0 second timeout
2025-03-13 10:30:11,756 INFO    MainThread:44695 [wandb_init.py:init():781] starting run threads in backend
2025-03-13 10:30:34,944 INFO    MainThread:44695 [wandb_run.py:_console_start():2159] atexit reg
2025-03-13 10:30:34,944 INFO    MainThread:44695 [wandb_run.py:_redirect():2014] redirect: wrap_raw
2025-03-13 10:30:34,945 INFO    MainThread:44695 [wandb_run.py:_redirect():2079] Wrapping output streams.
2025-03-13 10:30:34,945 INFO    MainThread:44695 [wandb_run.py:_redirect():2104] Redirects installed.
2025-03-13 10:30:34,946 INFO    MainThread:44695 [wandb_init.py:init():822] run started, returning control to user process
2025-03-13 10:30:35,004 INFO    MainThread:44695 [wandb_run.py:_config_callback():1282] config_cb None None {'data:dataset:seed': 123, 'data:dataset:use_rotate_enhance': False, 'data:dataset:split_frac': 1.0, 'data:dataset:use_split': True, 'data:dataset:split_len': 600, 'data:dataset:min_num_res': 32, 'data:dataset:max_num_res': 2000, 'data:dataset:cache_num_res': 0, 'data:dataset:subset': None, 'data:dataset:samples_per_eval_length': 5, 'data:dataset:num_eval_lengths': 32, 'data:dataset:max_eval_length': 2000, 'data:dataset:max_valid_num': 50, 'data:dataset:csv_path': './dataset/ATLAS/select/pkl/metadata_merged.csv', 'data:loader:num_workers': 8, 'data:loader:prefetch_factor': 10, 'data:sampler:max_batch_size': 64, 'data:sampler:max_num_res_squared': 500000, 'data:sampler:use_batch_repeats': False, 'data:sampler:num_batches': None, 'interpolant:min_t': 0.01, 'interpolant:separate_t': True, 'interpolant:provide_kappa': True, 'interpolant:hierarchical_t': False, 'interpolant:add_noise': True, 'interpolant:rots:train_schedule': 'linear', 'interpolant:rots:sample_schedule': 'exp', 'interpolant:rots:exp_rate': 10, 'interpolant:rots:noise_scale': 1.5, 'interpolant:trans:batch_ot': True, 'interpolant:trans:train_schedule': 'linear', 'interpolant:trans:sample_schedule': 'linear', 'interpolant:trans:noise_scale': 10.0, 'interpolant:trans:sample_temp': 1.0, 'interpolant:trans:vpsde_bmin': 0.1, 'interpolant:trans:vpsde_bmax': 20.0, 'interpolant:sampling:num_timesteps': 100, 'interpolant:sampling:do_sde': False, 'interpolant:self_condition': True, 'model:dropout': 0.2, 'model:node_embed_size': 256, 'model:edge_embed_size': 128, 'model:symmetric': False, 'model:use_torsions': True, 'model:use_adapter_node': True, 'model:use_mid_bb_update': False, 'model:use_mid_bb_update_e3': False, 'model:use_e3_transformer': False, 'model:node_features:c_s': 256, 'model:node_features:c_pos_emb': 1280, 'model:node_features:c_timestep_emb': 256, 'model:node_features:embed_diffuse_mask': False, 'model:node_features:separate_t': True, 'model:node_features:max_num_res': 2000, 'model:node_features:timestep_int': 1000, 'model:node_features:dropout': 0.2, 'model:edge_features:single_bias_transition_n': 2, 'model:edge_features:c_s': 256, 'model:edge_features:c_p': 128, 'model:edge_features:relpos_k': 64, 'model:edge_features:use_rbf': True, 'model:edge_features:num_rbf': 64, 'model:edge_features:feat_dim': 128, 'model:edge_features:num_bins': 64, 'model:edge_features:max_dist': 30.0, 'model:edge_features:dropout': 0.2, 'model:edge_features:self_condition': True, 'model:ipa:c_s': 256, 'model:ipa:c_z': 128, 'model:ipa:c_hidden': 128, 'model:ipa:no_heads': 16, 'model:ipa:no_qk_points': 32, 'model:ipa:no_v_points': 8, 'model:ipa:seq_tfmr_num_heads': 16, 'model:ipa:seq_tfmr_num_layers': 2, 'model:ipa:num_blocks': 6, 'model:ipa:dropout': 0.2, 'experiment:debug': False, 'experiment:seed': 123, 'experiment:num_devices': 1, 'experiment:warm_start': None, 'experiment:warm_start_cfg_override': True, 'experiment:use_swa': False, 'experiment:batch_ot:enabled': True, 'experiment:batch_ot:cost': 'kabsch', 'experiment:batch_ot:noise_per_sample': 1, 'experiment:batch_ot:permute': False, 'experiment:training:min_plddt_mask': None, 'experiment:training:t_normalize_clip': 0.9, 'experiment:training:loss': 'se3_vf_loss', 'experiment:training:translation_loss_weight': 0.2, 'experiment:training:rotation_loss_weights': 1.0, 'experiment:training:bb_atom_scale': 0.1, 'experiment:training:aux_loss_weight': 1.0, 'experiment:training:aux_loss_t_pass': 0.25, 'experiment:training:aatype_loss_weight': 0.0, 'experiment:wandb:name': 'loss_full', 'experiment:wandb:project': 'P2DFlow', 'experiment:wandb:save_code': True, 'experiment:wandb:tags': [], 'experiment:optimizer:lr': 0.0001, 'experiment:trainer:overfit_batches': 0, 'experiment:trainer:min_epochs': 1, 'experiment:trainer:max_epochs': 2000, 'experiment:trainer:accelerator': 'gpu', 'experiment:trainer:log_every_n_steps': 1, 'experiment:trainer:deterministic': False, 'experiment:trainer:strategy': 'ddp_find_unused_parameters_true', 'experiment:trainer:check_val_every_n_epoch': 1, 'experiment:trainer:accumulate_grad_batches': 2, 'experiment:trainer:gradient_clip_val': 10, 'experiment:checkpointer:dirpath': 'ckpt/P2DFlow/loss_full/2025-03-13_10-30-03', 'experiment:checkpointer:save_last': True, 'experiment:checkpointer:save_top_k': 2000, 'experiment:checkpointer:monitor': 'valid/rmsd_loss', 'experiment:checkpointer:mode': 'min'}
2025-03-13 10:30:38,243 INFO    MainThread:44695 [wandb_run.py:_config_callback():1282] config_cb None None {'cfg': "{'data': {'dataset': {'seed': 123, 'use_rotate_enhance': False, 'split_frac': 1.0, 'use_split': True, 'split_len': 600, 'min_num_res': 32, 'max_num_res': 2000, 'cache_num_res': 0, 'subset': None, 'samples_per_eval_length': 5, 'num_eval_lengths': 32, 'max_eval_length': 2000, 'max_valid_num': 50, 'csv_path': './dataset/ATLAS/select/pkl/metadata_merged.csv'}, 'loader': {'num_workers': 8, 'prefetch_factor': 10}, 'sampler': {'max_batch_size': 64, 'max_num_res_squared': 500000, 'use_batch_repeats': False, 'num_batches': None}}, 'interpolant': {'min_t': 0.01, 'separate_t': True, 'provide_kappa': True, 'hierarchical_t': False, 'add_noise': True, 'rots': {'train_schedule': 'linear', 'sample_schedule': 'exp', 'exp_rate': 10, 'noise_scale': 1.5}, 'trans': {'batch_ot': True, 'train_schedule': 'linear', 'sample_schedule': 'linear', 'noise_scale': 10.0, 'sample_temp': 1.0, 'vpsde_bmin': 0.1, 'vpsde_bmax': 20.0}, 'sampling': {'num_timesteps': 100, 'do_sde': False}, 'self_condition': '${model.edge_features.self_condition}'}, 'model': {'dropout': 0.2, 'node_embed_size': 256, 'edge_embed_size': 128, 'symmetric': False, 'use_torsions': True, 'use_adapter_node': True, 'use_mid_bb_update': False, 'use_mid_bb_update_e3': False, 'use_e3_transformer': False, 'node_features': {'c_s': '${model.node_embed_size}', 'c_pos_emb': 1280, 'c_timestep_emb': '${model.node_embed_size}', 'embed_diffuse_mask': False, 'separate_t': '${interpolant.separate_t}', 'max_num_res': 2000, 'timestep_int': 1000, 'dropout': '${model.dropout}'}, 'edge_features': {'single_bias_transition_n': 2, 'c_s': '${model.node_embed_size}', 'c_p': '${model.edge_embed_size}', 'relpos_k': 64, 'use_rbf': True, 'num_rbf': 64, 'feat_dim': '${model.edge_embed_size}', 'num_bins': 64, 'max_dist': 30.0, 'dropout': '${model.dropout}', 'self_condition': True}, 'ipa': {'c_s': '${model.node_embed_size}', 'c_z': '${model.edge_embed_size}', 'c_hidden': '${model.edge_embed_size}', 'no_heads': 16, 'no_qk_points': 32, 'no_v_points': 8, 'seq_tfmr_num_heads': 16, 'seq_tfmr_num_layers': 2, 'num_blocks': 6, 'dropout': '${model.dropout}'}}, 'experiment': {'debug': False, 'seed': 123, 'num_devices': 1, 'warm_start': None, 'warm_start_cfg_override': True, 'use_swa': False, 'batch_ot': {'enabled': True, 'cost': 'kabsch', 'noise_per_sample': 1, 'permute': False}, 'training': {'min_plddt_mask': None, 't_normalize_clip': 0.9, 'loss': 'se3_vf_loss', 'translation_loss_weight': 0.2, 'rotation_loss_weights': 1.0, 'bb_atom_scale': 0.1, 'aux_loss_weight': 1.0, 'aux_loss_t_pass': 0.25, 'aatype_loss_weight': 0.0}, 'wandb': {'name': 'loss_full', 'project': 'P2DFlow', 'save_code': True, 'tags': []}, 'optimizer': {'lr': 0.0001}, 'trainer': {'overfit_batches': 0, 'min_epochs': 1, 'max_epochs': 2000, 'accelerator': 'gpu', 'log_every_n_steps': 1, 'deterministic': False, 'strategy': 'ddp_find_unused_parameters_true', 'check_val_every_n_epoch': 1, 'accumulate_grad_batches': 2, 'gradient_clip_val': 10}, 'checkpointer': {'dirpath': 'ckpt/${experiment.wandb.project}/${experiment.wandb.name}/${now:%Y-%m-%d}_${now:%H-%M-%S}', 'save_last': True, 'save_top_k': 2000, 'monitor': 'valid/rmsd_loss', 'mode': 'min'}}}", 'folding_cfg': None}
